<div class="Final_work">
  <div class="box_container">

    <div class="Final_work_block">
      <div class="split">
        <div class="text">
          [[*final_work_template_head_text]]
        </div>
        <img class="image" src="[[*final_work_template_img]]" alt="Графика курса">
      </div>
    </div>



    <div class="How_is_the_training_going">
      <h2>
        Как проходит обучение
      </h2>
      <ol class="grid">
        <!-- <div class="selected-line"></div> -->

        {set $rows = json_decode($_modx->resource.final_work_template_migx, true)}
        {set $i = 1}
        {foreach $rows as $row}
        <li class="training-box active">
          <h4>0{$i}</h4>
          {$row.describe}
        </li>
        {set $i += 1}
        {/foreach}
      </ol>
    </div>

    <div class="Student_reviews">
      <h2>
        Отзывы студентов
      </h2>
      <div class="carousel">
        <div class="coments">
          <button class="carousel-control-prev" type="button"></button>
          <div class="box">
            <div class="inner">

              <!-- {set $rows = json_decode($_modx->resource.comments_migx, true)}
              {foreach $rows as $row}
              <h5>{$row.client}</h5>
              {$row.comment_text}
              <client-coment client={$row.client} text={$row.comment_text}></client-coment>
              {/foreach} -->
            </div>
          </div>

          <button class="carousel-control-next" type="button"></button>
        </div>
      </div>

      <div class="Cource_participation">
        <div class="part Cost_of_participation">
          [[*describe_near_form_reg]]
        </div>

        <a id="enroll-form" style="
                      visibility: hidden;
                      position: relative;
                      top: -60px;
                      display: block;
                  ">
        </a>

        <div class="part Enroll_in_a_course">
          [[*header_form_reg]]

          <!-- &hooks=`FormItSaveForm,excelFormRequest,Test,csrf,course` -->

          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
          [[!AjaxForm?
          &snippet=`FormIt`
          &hooks=`FormItSaveForm`
          &form=`tpl_ajax_form`
          &formName=`Курс Excel`
          &formFields=`name_and_surname, email, phone,company, job`
          &fieldNames=`name_and_surname==Имя, email==Электронная почта, phone==Телефон, company==Организация,
          job==Должность`
          &validate=`
          name_and_surname:required:minLength=^3^:maxLength=^21^,
          email:required:email,
          phone:required:regexp=^/^\+7 \([0-9][0-9][0-9]\) [0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]/^,
          company:required:minLength=^3^,
          job:required:minLength=^3^,
          workemail:blank
          `
          &successMessage=`Сообщение успешно отправлено`
          &validationErrorMessage=`В форме qwesad ошибки!`
          ]]

          <script type="text/javascript">
            // $(function() {
            //   $('form').submit(function(e) {
            //     var $form = $(this);
            //     $.ajax({
            //       type: $form.attr('method'),
            //       url: $form.attr('action'),
            //       data: $form.serialize()
            //     }).done(function() {
            //       console.log('success');
            //     }).fail(function() {
            //       console.log('fail');
            //     });
            //     //отмена действия по умолчанию для кнопки submit
            //     e.preventDefault();
            //   });
            // });

            $(function () {
              $('form').submit(function (e) {
                e.preventDefault();
                var m_method = $(this).attr('method');
                var m_action = $(this).attr('action');
                var m_data = $(this).serialize();
                $.ajax({
                  type: m_method,
                  url: m_action,
                  data: m_data,
                });
              });
            });
          </script>


        </div>
      </div>
    </div>


    <div class="Frequently_Asked_Questions">
      <h2>
        Часто задаваемые вопросы
      </h2>
      <div class="split">
        <div class="list">
          {set $rows = json_decode($_modx->resource.faq_migx, true)}
          {foreach $rows as $row}
          <details>
            <summary>
              {$row.question}
            </summary>
            <p>{$row.answer_text}</p>
          </details>
          {/foreach}
        </div>
      </div>
    </div>

  </div>
</div>